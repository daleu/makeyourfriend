doctype html(lang='en')
head
    title CREATE EVENT
    link(rel="shortcut icon" href="/images/logo_v4_100.png")
    meta(charset='utf-8')
    meta(name='viewport', content='width=device-width, initial-scale=1')

    link(rel='stylesheet', href='/css/bootstrap.min.css')
    link(rel='stylesheet', href='/style/style.css')
    link(rel='stylesheet', href='/css/w3.css')
    link(rel='stylesheet', href='/style/datepicker.min.css')
    link(rel='stylesheet', href='/css/font-awesome.min.css')
    script(src='/js/jquery.min.js')
    script(src='/js/datepicker.min.js')
    script(src='/js/datepicker.en.js')
    script(src='/js/bootstrap.min.js')
    script(src='/js/jquery.validate.min.js')
    script(type='text/javascript', src='js/materialize.min.js')
body
    nav.navbar.navbar-default.navbar-fixed-top
        .container-fluid(style='background-color: rgb(42, 124, 82) important;')
            .navbar-header
                button.navbar-toggle.collapsed(type='button', data-toggle='collapse', data-target='#bs-example-navbar-collapse-1', aria-expanded='false')
                    span.sr-only Toggle navigation
                    span.icon-bar
                    span.icon-bar
                    span.icon-bar
                a.navbar-brand(href='/')
                    img(alt="Brand" src="/images/logo_v4_100.png" height='60px;' style='margin-top:5px !important;')
            #bs-example-navbar-collapse-1.collapse.navbar-collapse
                ul.nav.navbar-nav
                    li
                        a(href='/')
                            span.fa.fa-home
                            |  HOME
                ul.nav.navbar-nav.navbar-right
                    li
                        a(href='/logout')
                            span.fa.fa-sign-out
                            |  SIGN OUT
                    li.dropdown
                        a.dropdown-toggle(href='#', data-toggle='dropdown', role='button', aria-haspopup='true', aria-expanded='false')
                            | LANGUAGE
                            span.fa.fa-chevron-down(style='margin-left:10px;')
                        ul.dropdown-menu
                            li
                                a(href='/register-ca') CATALÃ€
                            li
                                a(href='#') CASTELLANO
                            li
                                a(href='#') ENGLISH
    .w3-display-topmiddle
        .w3-card-4(style='margin-top:90px; margin-bottom:50px; background-color: white;')
            header.w3-container
                h1 CREATE EVENT
                    span.fa.fa-plus-circle(style='margin-left:10px;')
            form#registerform.w3-container(action="/create-event", method="post")
                label.w3-text
                    b(style='text-decoration:underline;') EVENT TITLE
                        sup
                            span.fa.fa-asterisk
                input.w3-input.w3-border(type='text', style="text-transform:uppercase;",name='title', placeholder="WRITE THE TITLE OF THE EVENT" required)
                p
                label.w3-text
                    b(style='text-decoration:underline;') START EVENT TIME
                        sup
                            span.fa.fa-asterisk
                p
                input#datapickerstart.datepicker-here.w3-input.w3-border(type='text',name='start', data-language='en', data-timepicker="true", placeholder="WRITE OR SELECT YOUR EVENT DATE. THE FORMAT NEEDS TO BE LIKE THIS EXAMPLE: 10/22/1995" required)
                p
                    label.w3-text
                        b(style='text-decoration:underline;') END EVENT TIME
                            sup
                                span.fa.fa-asterisk
                    p
                    input#datapickerend.datepicker-here.w3-input.w3-border(type='text',name='end', data-language='en', data-timepicker="true", placeholder="WRITE OR SELECT YOUR EVENT DATE. THE FORMAT NEEDS TO BE LIKE THIS EXAMPLE: 10/22/1995" required)
                p
                label.w3-text
                    b(style='text-decoration:underline;') EVENT PLACE
                        sup
                            span.fa.fa-asterisk
                input.w3-input.w3-border(type='text', style="text-transform:uppercase;",name='place', placeholder="WRITE THE TITLE OF THE EVENT" required)
                p
                label.w3-text
                    b(style='text-decoration:underline;') STORY DESCRIPTION
                textarea.w3-input.w3-border(style='width:50vw; text-transform:uppercase;',name='description',placeholder="WRITE HERE WHAT YOU WANT TO TELL YOUR FRIENDS" required)
                button#submitbutton.w3-btn.w3-padding(type='button', style='margin-top:10px; margin-bottom:10px; position:relative; float:right;')
                    span.fa.fa-upload
                    b &nbsp; &nbsp; CREATE EVENT
    #spinnerbackground
    #spinner
    #infobackground
    #infocard.w3-display-middle
        .w3-card-4(style='margin-top:75px !important;')
            header.w3-container.w3-blue
                h1 INFORMATION
                    span.fa.fa-info-circle(style='margin-left:10px;')
            .w3-container(style="background-color: white;")
                p
                | TO HAVE AN ACCOUNT ON THIS PAGE, YOU NEED TO FILL UP THIS PAGE, AND THEN CLICK ON REGISTER BUTTON BELOW.
                p
                | THING TO BE CONSIDERED:
                p
                    | - THE FIELDS THAT HAVE
                    sup
                        span.fa.fa-asterisk
                    |  SYMBOL ARE REQUIRED TO BE REGISTRED ON THIS PAGE.
                P
                    | - THE
                    b  BIRTHDAY DATE
                    |  MUST HAVE THE FORMAT MONTH/DAY/YEAR.
                P
                    | - THE
                    b  EMAIL
                    |  FIELD NEEDS TO BE A REAL EMAIL.
                P
                    | - THE
                    b  PASSWORDS
                    |  HAVE TO BE IDENTICAL, AND HAVE TO BE AT LEAST 8 CHARACTERS.
                P
                    | - IN THE
                    b  PASSWORD FIELDS
                    | , YOU CAN SEE WHAT YOU HAVE WRITTEN PASSING YOUR MOUSE ABOVE THE EYE '
                    span.fa.fa-eye
                    | ' ON THE RIGHT.
                p
                    b ENJOY THE EXPERIENCE!!! :-)
                p
            footer.w3-container.w3-blue
                button#closeinfo.w3-btn.w3-padding(type='button', style='width:155px; margin-top:10px; margin-bottom:10px; float: right;') CLOSE
                    span.fa.fa-close(style='margin-left:10px;')
    #errorcard.w3-display-middle
        .w3-card-4
            header.w3-container.w3-red
                h1 ERROR
                    span.fa.fa-exclamation-circle(style='margin-left:10px;')
            .w3-container(style="background-color: white;")
                p
                | THIS EMAIL ALREADY EXISTS IN OUR SYSTEM.
                | PLIS, PUT ANOTHER ONE.
                p
            footer.w3-container.w3-red
                button#closeerror.w3-btn.w3-padding(type='button', style='width:155px; margin-top:10px; margin-bottom:10px; float: right;') CLOSE
                    span.fa.fa-close(style='margin-left:10px;')
script.

    $("#submitbutton").click(function () {
        var form = $("#registerform");
        form.validate({
            rules: {
                start: {
                    isValidDateStart: true
                },
                end: {
                    isValidDateEnd: true
                }
            }
        });

        if (form.valid()) {
            $('#spinnerbackground').css('display', 'block');
            $('#spinner').css('display', 'block');
            form.submit();
        }
    });

    $("#infobutton").click(function () {
        $('#infobackground').css('display', 'block');
        $('#infocard').css('display', 'block');
    });

    $("#closeinfo").click(function () {
        $('#infobackground').css('display', 'none');
        $('#infocard').css('display', 'none');
    });

    /*TEST VALID DATE*/
    $.validator.addMethod("isValidDateStart",
        function () {

            var dateString = $('#datapickerstart').val();

            var dateStringArray = dateString.split(" ");


            if (!/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(dateStringArray[0])) return false;

            //Get Date parts to Integer
            var parts = dateStringArray[0].split("/");
            var day = parseInt(parts[1], 10);
            var month = parseInt(parts[0], 10);
            var year = parseInt(parts[2], 10);

            //Check month and year ranges
            var actualYear = new Date().getFullYear();
            if (year < actualYear - 100 || year > actualYear || month <= 0 || month > 12) return false;

            //Define month days
            var monthLenght = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];

            //Leap years
            if (year % 400 == 0 || (year % 100 != 0 && year % 4 == 0)) monthLenght[1] = 29;

            //Check day range
            if(day <= 0 || day > monthLenght[month - 1]) return false;

            if(dateStringArray[2]!= "PM" && dateStringArray[2]!= "AM" && dateStringArray[2]!= "am" && dateStringArray[2]!= "pm") return false;

            var parts2 = dateStringArray[1].split(":");
            var hour = parseInt(parts2[0]);
            var minute = parseInt(parts2[1]);

            return hour > 0 && hour <13 && minute >=0 && minute<60;
        },
        "Please enter a date in the format mm/dd/yyyy."
    );

    /*TEST VALID DATE*/
    $.validator.addMethod("isValidDateEnd",
        function () {

            var dateString = $('#datapickerend').val();

            var dateStringArray = dateString.split(" ");


            if (!/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(dateStringArray[0])) return false;

            //Get Date parts to Integer
            var parts = dateStringArray[0].split("/");
            var day = parseInt(parts[1], 10);
            var month = parseInt(parts[0], 10);
            var year = parseInt(parts[2], 10);

            //Check month and year ranges
            var actualYear = new Date().getFullYear();
            if (year < actualYear - 100 || year > actualYear || month <= 0 || month > 12) return false;

            //Define month days
            var monthLenght = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];

            //Leap years
            if (year % 400 == 0 || (year % 100 != 0 && year % 4 == 0)) monthLenght[1] = 29;

            //Check day range
            if (day <= 0 || day > monthLenght[month - 1]) return false;

            if (dateStringArray[2] != "PM" && dateStringArray[2] != "AM" && dateStringArray[2] != "am" && dateStringArray[2] != "pm") return false;

            var parts2 = dateStringArray[1].split(":");
            var hour = parseInt(parts2[0]);
            var minute = parseInt(parts2[1]);

            return hour > 0 && hour < 13 && minute >= 0 && minute < 60;
        },
        "Please enter a date in the format mm/dd/yyyy."
    );